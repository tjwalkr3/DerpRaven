<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:DerpRaven.Maui.ViewModels"
             x:Class="DerpRaven.Maui.Views.OrderHistoryPage"
             Title="OrderHistoryPage">
    <ScrollView>
        <CollectionView ItemsSource="{Binding Orders}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <VerticalStackLayout Padding="10" Spacing="10">
                        <Border Stroke="Gray" Padding="10" Margin="5">
                            <VerticalStackLayout>
                                <Button Text="{Binding OrderDate, StringFormat='Order {0:MM/dd/yyyy}'}"
                                        Command="{Binding ToggleExpandCommand}" />

                                <CollectionView ItemsSource="{Binding Products}" 
                                                IsVisible="{Binding IsExpanded}">
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <VerticalStackLayout>
                                                <Label>
                                                    <Label.Text>
                                                        <MultiBinding StringFormat="{}{0} - {1}">
                                                            <Binding Path="Name" />
                                                            <Binding Path="Price" />
                                                        </MultiBinding>
                                                    </Label.Text>
                                                </Label>
                                            </VerticalStackLayout>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>
                            </VerticalStackLayout>
                        </Border>
                    </VerticalStackLayout>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </ScrollView>
</ContentPage>
